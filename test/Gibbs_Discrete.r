######################################## TITLE: GIBBS_DISCRETE.R# PURPOSE: ILLUSTRATE GIBBS SAMPLING IN A SIMPLE BIVARIATE DISCRETE MODEL####################################  # the function sample1 takes a starting value for b as input, samples "a" from# the conditional distribution of a|b, and then, with this new "a", samples a# value from b|a.  it returns the samplessample1 = function(b) {a = sample(c(1,2),1,prob=joint[,b])  # simulate from a|b# Note: The new versions of sample# allow us to avoid division by# the marginal distribution.b = sample(c(1,2,3),1,prob=joint[a,]) # simulate from b|ainvisible(list(a=a,b=b))} samplen = function(n=1000) {a = 1b = 1aa = rep(NaN,n)bb = rep(NaN,n)myjoint = matrix(0,nrow=2,ncol=3) for(i in 1:n) {z = sample1(b)aa[i] = a = z$abb[i] = b = z$bmyjoint[a,b] =myjoint[a,b]+1}   # end for loop print(myjoint/sum(myjoint))print(joint)invisible(list(aa=aa,bb=bb))}   # end function 'samplen'  joint = c(.1,.2,.2,.1,.3,.1)dim(joint) = c(2,3)z=samplen(1000)par(mfrow=c(2,1))hist(z$aa) #a marginalhist(z$bb) #b marginal